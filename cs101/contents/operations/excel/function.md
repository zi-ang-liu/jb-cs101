# 関数

## 関数とは

数学において，関数$f: X \to Y$は，集合$A$の各元に対し，集合$B$の元を1つだけ対応させる規則のことを指します．

Excelでは，事前に定義された計算式を「関数」と呼びます．Excelにおいても，関数は同様に，ある値を入力すると別の値を出力する規則を指します．Excelの関数は，数値や文字列などのデータを引数として受け取り，計算結果を返します．

例えば，`SUM`関数は，指定した範囲内の数値を引数として受け取り，その合計を計算して返します．`AVERAGE`関数は，指定した範囲内の数値を引数として受け取り，その平均値を計算して返します．

## 関数の構文
Excelの関数を用いて計算を行うため、関数の構文を理解する必要があります。Excelの関数は、以下のような形式で記述します。

```excel
= 関数名(引数1, 引数2, ...)
```

## AVERAGE関数

ここでは，`AVERAGE`関数を例に説明します．`AVERAGE`関数は，指定した範囲内の数値の平均を計算するための関数です．以下の構文を使用します．

```excel
= AVERAGE(数値1, [数値2], ...)
```

`AVERAGE`関数を使用して，学生の各科目の平均点を計算してみましょう．

| 学籍番号 | 数学  | 英語  | 情報  |
| :------: | :---: | :---: | :---: |
|  s1001   |  87   |  92   |  85   |
|  s1002   |  78   |  85   |  90   |
|  s1003   |  55   |  62   |  40   |

## IF関数

Excelの関数では，引数に数値だけでなく，文字列や論理値（TRUE/FALSE）を指定することもできます．

例えば，`IF`関数は，条件に基づいて異なる値を返すための関数です．以下の構文を使用します．

```excel
= IF(条件, 真の場合の値, 偽の場合の値)
```

例えば、成績が60点以上の場合は「合格」、それ以外の場合は「不合格」と表示する場合、以下のように入力します。

```excel
= IF(F2 >= 60, "合格", "不合格")
```

学生の平均点を計算し、60点以上の場合は「進級」、それ以外の場合は「留年」と表示する`IF`関数を作ってみましょう。

## 関数ネスト

関数を他の関数の引数として使用することを「関数ネスト」と呼びます。

例えば、次の数式では、セル`B4`から`D4`の平均値を計算し、その結果が90以上の場合は「合格」、それ以外の場合は「不合格」と表示します。

```excel
= IF(AVERAGE(B4:D4) >= 90, "合格", "不合格")
```

## よく使う関数

:::{note}
Excelでは、`SUM()`、`AVERAGE()`、`MAX()`、`MIN()`など様々な関数が用意されています。すべての関数を覚える必要はありませんが、よく使う関数を覚えておくと便利です。また、どの関数を使えばよいか分からない場合は、GoogleやChatGPTに聞いてみましょう。
:::


### ROUND関数
ROUND関数は、数値を指定した桁数に四捨五入するための関数です。以下の構文を使用します。

```excel
= ROUND(数値, 桁数)
```

- 関数名：`ROUND`
- 引数1：四捨五入する数値
- 引数2：四捨五入する桁数（整数）

`3.14159`を小数点以下2桁に四捨五入する場合、以下のように入力します。

```excel
= ROUND(3.14159, 2)
```

### SUM関数

指定した範囲内の数値を合計する。

```excel
= SUM(数値1, [数値2], ...)
```

### MEDIAN関数

中央値

```excel
= MEDIAN(数値1, [数値2], ...)
```
### MAX関数

最大値

```excel
= MAX(数値1, [数値2], ...)
```

### MIN関数

最小値

```excel
= MIN(数値1, [数値2], ...)
```

### IF関数

条件に基づいて異なる値を返す。

```excel
= IF(論理式, 値が真の場合, 値が偽の場合)
```

次に例を示します。B2の値が60以上の場合は「合格」、それ以外の場合は「不合格」と表示します。

```excel
= IF(B2 >= 60, "合格", "不合格")
```

### COUNT関数

指定した範囲内の数値の個数をカウントする。

```excel
= COUNT(数値1, [数値2], ...)
```

### COUNTIF関数

指定した条件を満たすセルの個数をカウントする。

```excel
= COUNTIF(範囲, 条件)
```

次に例を示します。B2からB10の範囲で、60以上の値を持つセルの個数をカウントします。

```excel
= COUNTIF(B2:B10, ">=60")
```

次の例では、B2からB10の範囲で、「合格」と表示されているセルの個数をカウントします。

```excel
= COUNTIF(B2:B10, "合格")
```

### CORREL関数

2つの配列の相関係数を計算する。

```excel
= CORREL(配列1, 配列2)
```

次の例では、B2からB10の範囲とC2からC10の範囲の相関係数を計算します。

```excel
= CORREL(B2:B10, C2:C10)
```

## 練習

以下の表を参考に，以下の問題を解いてみましょう．

| 学籍番号 | 数学  | 英語  | 情報  | 進級判定 |
| :------: | :---: | :---: | :---: | :------: |
|  s1001   |  87   |  92   |  85   |          |
|  s1002   |  78   |  85   |  90   |          |
|  s1003   |  55   |  62   |  40   |          |
|  平均点  |       |       |       |          |
|  最高点  |       |       |       |          |
|  最低点  |       |       |       |          |
| 合格者数 |       |       |       |          |

1. 各科目の平均点，最高点，最低点，合格者数を計算し，セルに記入せよ．
2. 各学生の進級判定を行い，平均点が60以上の場合は「進級」，それ以外の場合は「留年」と表示せよ．関数ネストを使用すること．


