# 計算

ここでは、以下の例を用いて、Excelの計算機能を紹介します。

| 学籍番号 | 数学  | 英語  | 情報  |
| :------: | :---: | :---: | :---: |
|  s1001   |  87   |  92   |  85   |
|  s1002   |  78   |  85   |  90   |
|  s1003   |  95   |  88   |  92   |

## 基本演算

### 演算子

Excelでは、数値の計算を行うために、`=`で始まる数式を使用します。数式には、`+`（加算）、`-`（減算）、`*`（乗算）、`/`（除算）などの演算子を使用します。例えば、成績の合計を計算する場合、以下のように入力して、<kbd>Enter</kbd>キーを押すと、計算結果が表示されます。

```excel
= 87 + 92 + 85
```

:::{figure-md} excel_calculation
<img src="./images/calculate/excel_calculation.png" alt="計算" width="600px">

基本的な計算
:::

### 値の参照

Excelでは、他のセルの値を参照して計算を行うことができます。例えば、数学の成績の合計を計算する場合、以下のように入力します。

```excel
= B3 + C3 + D3
```

:::{figure-md} excel_reference
<img src="./images/calculate/excel_reference.png" alt="値の参照" width="600px">

値の参照
:::

以下では、例を使って、参照の書式を説明します。

- `A10`：列A、行10のセル
- `B3:D3`：行3、列BからDの範囲
- `A1:A10`：列A、行1から10の範囲
- `B3:D10`：行3〜10、列B〜Dの範囲


### 初めての関数

Excelには、さまざまな関数が用意されています。関数を使用することで、複雑な計算を簡単に行うことができます。例えば、合計を計算する場合、`SUM`関数を使用します。`SUM`関数は、指定した範囲内の数値を合計するための関数です。以下の数式は、`B4`から`D4`の範囲内の数値を合計します。

```excel
= SUM(B4:D4)
```

:::{figure-md} excel_function
<img src="./images/calculate/excel_function.png" alt="初めての関数" width="600px">

初めての関数
:::

### 小数点数

`AVERAGE`関数を使って、`s1001`の数学、英語、情報の平均点を計算してみましょう。`B2:D2`の範囲を選択して、`F2`に以下の数式を入力します。

```excel    
= AVERAGE(B2:D2)
```

平均値は整数部分で表示されます。小数点以下の値を表示するには、「数値」グループの「小数点以下の表示桁数を増やす」ボタンをクリックします。

:::{figure-md} excel_decimal
<img src="./images/calculate/excel_decimal.png" alt="小数点数" width="600px">

小数点数
:::

### 連続データの計算

そして、マウスでセルの右下隅をドラッグすると、他の行にも同じ計算を適用できます。

:::{figure-md} excel_average
<img src="./images/calculate/excel_average.png" alt="連続データの計算" width="600px">

連続データの計算
:::


## 関数

### 関数の構文
より複雑な計算を行う場合、関数の構文を理解する必要があります。Excelの関数は、以下のような形式で記述します。

```excel
= 関数名(引数1, 引数2, ...)
```

### ROUND関数
例えば、ROUND関数は、数値を指定した桁数に四捨五入するための関数です。以下の構文を使用します。

```excel
= ROUND(数値, 桁数)
```

- 関数名：`ROUND`
- 引数1：四捨五入する数値
- 引数2：四捨五入する桁数（整数）

`3.14159`を小数点以下2桁に四捨五入する場合、以下のように入力します。

```excel
= ROUND(3.14159, 2)
```

### IF関数

IF関数は、条件に基づいて異なる値を返すための関数です。以下の構文を使用します。

```excel
= IF(条件, 真の場合の値, 偽の場合の値)
```

例えば、成績が90点以上の場合は「合格」、それ以外の場合は「不合格」と表示する場合、以下のように入力します。

```excel
= IF(F2 >= 90, "合格", "不合格")
```

:::{note}
Excelでは、`SUM()`、`AVERAGE()`、`MAX()`、`MIN()`など様々な関数が用意されています。すべての関数を覚える必要はありませんが、よく使う関数を覚えておくと便利です。また、どの関数を使えばよいか分からない場合は、GoogleやChatGPTに聞いてみましょう。
:::

### 関数ネスト

関数を他の関数の引数として使用することを「関数ネスト」と呼びます。

例えば、次の数式では、セル`B4`から`D4`の平均値を計算し、その結果が90以上の場合は「合格」、それ以外の場合は「不合格」と表示します。

```excel
= IF(AVERAGE(B4:D4) >= 90, "合格", "不合格")
```